(function(x){function m(c){this.options=p.extend({},m.defaultOptions,c);this.clear()}function e(c){this.options=p.extend({},e.defaultChartOptions,c);this.seriesSet=[];this.currentValueRange=1;this.lastRenderTimeMillis=this.currentVisMinValue=0}var p={extend:function(){arguments[0]=arguments[0]||{};for(var c=1;c<arguments.length;c++)for(var b in arguments[c])arguments[c].hasOwnProperty(b)&&(arguments[0][b]="object"===typeof arguments[c][b]?arguments[c][b]instanceof Array?arguments[c][b]:p.extend(arguments[0][b],
arguments[c][b]):arguments[c][b]);return arguments[0]}};m.defaultOptions={resetBoundsInterval:3E3,resetBounds:!0};m.prototype.clear=function(){this.data=[];this.minValue=this.maxValue=Number.NaN};m.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1];this.minValue=this.data[0][1];for(var c=1;c<this.data.length;c++){var b=this.data[c][1];b>this.maxValue&&(this.maxValue=b);b<this.minValue&&(this.minValue=b)}}else this.minValue=this.maxValue=Number.NaN};m.prototype.append=
function(c,b,a){for(var f=this.data.length-1;0<=f&&this.data[f][0]>c;)f--; -1===f?this.data.splice(0,0,[c,b]):0<this.data.length&&this.data[f][0]===c?a?(this.data[f][1]+=b,b=this.data[f][1]):this.data[f][1]=b:f<this.data.length-1?this.data.splice(f+1,0,[c,b]):this.data.push([c,b]);this.maxValue=isNaN(this.maxValue)?b:Math.max(this.maxValue,b);this.minValue=isNaN(this.minValue)?b:Math.min(this.minValue,b)};m.prototype.dropOldData=function(c,b){for(var a=0;this.data.length-a>=b&&this.data[a+1][0]<c;)a++;
0!==a&&this.data.splice(0,a)};e.defaultChartOptions={millisPerPixel:20,enableDpiScaling:!0,yMinFormatter:function(c,b){return parseFloat(c).toFixed(b)},yMaxFormatter:function(c,b){return parseFloat(c).toFixed(b)},maxValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,sharpLines:!1,millisPerLine:1E3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2},
horizontalLines:[]};e.AnimateCompatibility=function(){return{requestAnimationFrame:function(c,b){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(function(){a((new Date).getTime())},16)}).call(window,c,b)},cancelAnimationFrame:function(c){return(window.cancelAnimationFrame||function(b){clearTimeout(b)}).call(window,c)}}}();e.defaultSeriesPresentationOptions=
{lineWidth:1,strokeStyle:"#ffffff"};e.prototype.addTimeSeries=function(c,b){this.seriesSet.push({timeSeries:c,options:p.extend({},e.defaultSeriesPresentationOptions,b)});c.options.resetBounds&&0<c.options.resetBoundsInterval&&(c.resetBoundsTimerId=setInterval(function(){c.resetBounds()},c.options.resetBoundsInterval))};e.prototype.removeTimeSeries=function(c){for(var b=this.seriesSet.length,a=0;a<b;a++)if(this.seriesSet[a].timeSeries===c){this.seriesSet.splice(a,1);break}c.resetBoundsTimerId&&clearInterval(c.resetBoundsTimerId)};
e.prototype.getTimeSeriesOptions=function(c){for(var b=this.seriesSet.length,a=0;a<b;a++)if(this.seriesSet[a].timeSeries===c)return this.seriesSet[a].options};e.prototype.bringToFront=function(c){for(var b=this.seriesSet.length,a=0;a<b;a++)if(this.seriesSet[a].timeSeries===c){c=this.seriesSet.splice(a,1);this.seriesSet.push(c[0]);break}};e.prototype.streamTo=function(c,b){this.canvas=c;this.delay=b;this.start()};e.prototype.start=function(){if(!this.frame){if(this.options.enableDpiScaling&&window&&
1!==window.devicePixelRatio){var c=this.canvas.getAttribute("width"),b=this.canvas.getAttribute("height");this.canvas.setAttribute("width",c*window.devicePixelRatio);this.canvas.setAttribute("height",b*window.devicePixelRatio);this.canvas.style.width=c+"px";this.canvas.style.height=b+"px";this.canvas.getContext("2d").scale(window.devicePixelRatio,window.devicePixelRatio)}var a=function(){this.frame=e.AnimateCompatibility.requestAnimationFrame(function(){this.render();a()}.bind(this))}.bind(this);
a()}};e.prototype.stop=function(){this.frame&&(e.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame)};e.prototype.updateValueRange=function(){for(var c=this.options,b=Number.NaN,a=Number.NaN,f=0;f<this.seriesSet.length;f++){var d=this.seriesSet[f].timeSeries;isNaN(d.maxValue)||(b=isNaN(b)?d.maxValue:Math.max(b,d.maxValue));isNaN(d.minValue)||(a=isNaN(a)?d.minValue:Math.min(a,d.minValue))}b=null!=c.maxValue?c.maxValue:b*c.maxValueScale;null!=c.minValue&&(a=c.minValue);this.options.yRangeFunction&&
(b=this.options.yRangeFunction({min:a,max:b}),a=b.min,b=b.max);isNaN(b)||isNaN(a)||(f=b-a-this.currentValueRange,d=a-this.currentVisMinValue,this.isAnimatingScale=.1<Math.abs(f)||.1<Math.abs(d),this.currentValueRange+=c.scaleSmoothing*f,this.currentVisMinValue+=c.scaleSmoothing*d);this.valueRange={min:a,max:b}};e.prototype.render=function(c,b){var a=(new Date).getTime();if(!this.isAnimatingScale){var f=Math.min(1E3/6,this.options.millisPerPixel);if(a-this.lastRenderTimeMillis<f)return}this.lastRenderTimeMillis=
a;c=c||this.canvas;b=b||a-(this.delay||0);b-=b%this.options.millisPerPixel;var a=c.getContext("2d"),d=this.options,e=c.clientWidth,l=c.clientHeight,f=b-e*d.millisPerPixel,q=function(a){a-=this.currentVisMinValue;return 0===this.currentValueRange?l:l-Math.round(a/this.currentValueRange*l)}.bind(this),m=function(a){return Math.round(e-(b-a)/d.millisPerPixel)};this.updateValueRange();a.font=d.labels.fontSize+"px "+d.labels.fontFamily;a.save();a.translate(0,0);a.beginPath();a.rect(0,0,e,l);a.clip();a.save();
a.fillStyle=d.grid.fillStyle;a.clearRect(0,0,e,l);a.fillRect(0,0,e,l);a.restore();a.save();a.lineWidth=d.grid.lineWidth;a.strokeStyle=d.grid.strokeStyle;if(0<d.grid.millisPerLine){a.beginPath();for(var g=b-b%d.grid.millisPerLine;g>=f;g-=d.grid.millisPerLine){var h=m(g);d.grid.sharpLines&&(h-=.5);a.moveTo(h,0);a.lineTo(h,l)}a.stroke();a.closePath()}for(g=1;g<d.grid.verticalSections;g++)h=Math.round(g*l/d.grid.verticalSections),d.grid.sharpLines&&(h-=.5),a.beginPath(),a.moveTo(0,h),a.lineTo(e,h),a.stroke(),
a.closePath();d.grid.borderVisible&&(a.beginPath(),a.strokeRect(0,0,e,l),a.closePath());a.restore();if(d.horizontalLines&&d.horizontalLines.length)for(g=0;g<d.horizontalLines.length;g++){var h=d.horizontalLines[g],k=Math.round(q(h.value))-.5;a.strokeStyle=h.color||"#ffffff";a.lineWidth=h.lineWidth||1;a.beginPath();a.moveTo(0,k);a.lineTo(e,k);a.stroke();a.closePath()}for(g=0;g<this.seriesSet.length;g++){a.save();var u=this.seriesSet[g].timeSeries,h=u.data,k=this.seriesSet[g].options;u.dropOldData(f,
d.maxDataSetLength);a.lineWidth=k.lineWidth;a.strokeStyle=k.strokeStyle;a.beginPath();for(var p=u=0,w=0,v=0;v<h.length&&1!==h.length;v++){var n=m(h[v][0]),r=q(h[v][1]);if(0===v)u=n,a.moveTo(n,r);else switch(d.interpolation){case "linear":case "line":a.lineTo(n,r);break;default:a.bezierCurveTo(Math.round((p+n)/2),w,Math.round(p+n)/2,r,n,r);break;case "step":a.lineTo(n,w),a.lineTo(n,r)}p=n;w=r}1<h.length&&(k.fillStyle&&(a.lineTo(e+k.lineWidth+1,w),a.lineTo(e+k.lineWidth+1,l+k.lineWidth+1),a.lineTo(u,
l+k.lineWidth),a.fillStyle=k.fillStyle,a.fill()),k.strokeStyle&&"none"!==k.strokeStyle&&a.stroke(),a.closePath());a.restore()}if(!d.labels.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var q=d.yMaxFormatter(this.valueRange.max,d.labels.precision),t=d.yMinFormatter(this.valueRange.min,d.labels.precision);a.fillStyle=d.labels.fillStyle;a.fillText(q,e-a.measureText(q).width-2,d.labels.fontSize);a.fillText(t,e-a.measureText(t).width-2,l-2)}if(d.timestampFormatter&&0<d.grid.millisPerLine)for(t=
e-a.measureText(t).width+4,g=b-b%d.grid.millisPerLine;g>=f;g-=d.grid.millisPerLine)h=m(g),h<t&&(q=d.timestampFormatter(new Date(g)),k=a.measureText(q).width,t=h-k-2,a.fillStyle=d.labels.fillStyle,a.fillText(q,h-k,l-2));a.restore()};e.timeFormatter=function(c){function b(a){return(10>a?"0":"")+a}return b(c.getHours())+":"+b(c.getMinutes())+":"+b(c.getSeconds())};x.TimeSeries=m;x.SmoothieChart=e})("undefined"===typeof exports?this:exports);
